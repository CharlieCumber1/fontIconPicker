/**
 *  jQuery fontIconPicker - v2.1.1
 *
 *  An icon picker built on top of font icons and jQuery
 *
 *  http://codeb.it/fontIconPicker
 *
 *  Made by Alessandro Benoit & Swashata
 *  Under MIT License
 *
 * {@link https://github.com/micc83/fontIconPicker}
 */
(function(e){"use strict";function n(n,r){this.element=e(n);this.settings=e.extend({},t,r);if(this.settings.emptyIcon){this.settings.iconsPerPage--}this.iconPicker=e("<div/>",{"class":"icons-selector",style:"position: relative",html:'<div class="selector">'+'<span class="selected-icon">'+'<i class="fip-icon-block"></i>'+"</span>"+'<span class="selector-button">'+'<i class="fip-icon-down-dir"></i>'+"</span>"+"</div>"+'<div class="selector-popup-wrap">'+'<div class="selector-popup" style="display: none;">'+(this.settings.hasSearch?'<div class="selector-search">'+'<input type="text" name="" value="" placeholder="Search icon" class="icons-search-input"/>'+'<i class="fip-icon-search"></i>'+"</div>":"")+'<div class="selector-category">'+'<select name="" class="icon-category-select" style="display: none">'+"</select>"+"</div>"+'<div class="fip-icons-container"></div>'+'<div class="selector-footer" style="display:none;">'+'<span class="selector-pages">1/2</span>'+'<span class="selector-arrows">'+'<span class="selector-arrow-left" style="display:none;">'+'<i class="fip-icon-left-dir"></i>'+"</span>"+'<span class="selector-arrow-right">'+'<i class="fip-icon-right-dir"></i>'+"</span>"+"</span>"+"</div>"+"</div>"+"</div>"});this.iconContainer=this.iconPicker.find(".fip-icons-container");this.searchIcon=this.iconPicker.find(".selector-search i");this.selectorPopup=this.iconPicker.find(".selector-popup-wrap");this.iconsSearched=[];this.isSearch=false;this.totalPage=1;this.currentPage=1;this.currentIcon=false;this.iconsCount=0;this.open=false;this.searchValues=[];this.availableCategoriesSearch=[];this.triggerEvent=null;this.backupSource=[];this.backupSearch=[];this.isCategorized=false;this.selectCategory=this.iconPicker.find(".icon-category-select");this.selectedCategory=false;this.availableCategories=[];this.unCategorizedKey=null;this.init()}var t={theme:"fip-grey",source:false,emptyIcon:true,emptyIconValue:"",autoClose:true,iconsPerPage:20,hasSearch:true,searchSource:false,appendTo:"self",useAttribute:false,attributeName:"data-icon",convertToHex:true,allCategoryText:"From all categories",unCategorizedText:"Uncategorized"};n.prototype={init:function(){this.iconPicker.addClass(this.settings.theme);this.iconPicker.css({left:-9999}).appendTo("body");var t=this.iconPicker.outerHeight(),n=this.iconPicker.outerWidth();this.iconPicker.css({left:""});this.element.before(this.iconPicker);this.element.css({visibility:"hidden",top:0,position:"relative",zIndex:"-1",left:"-"+n+"px",display:"inline-block",height:t+"px",width:n+"px",padding:"0",margin:"0 -"+n+"px 0 0",border:"0 none",verticalAlign:"top","float":"none"});if(!this.element.is("select")){var r=function(){var e=3,t=document.createElement("div"),n=t.all||[];while(t.innerHTML="<!--[if gt IE "+ ++e+"]><br><![endif]-->",n[0]);return e>4?e:!e}();var i=document.createElement("div");this.triggerEvent=r===9||!("oninput"in i)?["keyup"]:["input","keyup"]}if(!this.settings.source&&this.element.is("select")){this.settings.source=[];this.settings.searchSource=[];if(this.element.find("optgroup").length){this.isCategorized=true;this.element.find("optgroup").each(e.proxy(function(t,n){var r=this.availableCategories.length,i=e("<option />");i.attr("value",r);i.html(e(n).attr("label"));this.selectCategory.append(i);this.availableCategories[r]=[];this.availableCategoriesSearch[r]=[];e(n).find("option").each(e.proxy(function(t,n){var i=e(n).val(),s=e(n).html();if(i&&i!==this.settings.emptyIconValue){this.settings.source.push(i);this.availableCategories[r].push(i);this.searchValues.push(s);this.availableCategoriesSearch[r].push(s)}},this))},this));if(this.element.find("> option").length){this.element.find("> option").each(e.proxy(function(t,n){var r=e(n).val(),i=e(n).html();if(!r||r===""||r==this.settings.emptyIconValue){return true}if(this.unCategorizedKey===null){this.unCategorizedKey=this.availableCategories.length;this.availableCategories[this.unCategorizedKey]=[];this.availableCategoriesSearch[this.unCategorizedKey]=[];e("<option />").attr("value",this.unCategorizedKey).html(this.settings.unCategorizedText).appendTo(this.selectCategory)}this.settings.source.push(r);this.availableCategories[this.unCategorizedKey].push(r);this.searchValues.push(i);this.availableCategoriesSearch[this.unCategorizedKey].push(i)},this))}}else{this.element.find("option").each(e.proxy(function(t,n){var r=e(n).val(),i=e(n).html();if(r){this.settings.source.push(r);this.searchValues.push(i)}},this))}this.backupSource=this.settings.source.slice(0);this.backupSearch=this.searchValues.slice(0);this.loadCategories()}else{this.initSourceIndex()}this.loadIcons();this.iconPicker.find(".selector-button").click(e.proxy(function(e){e.stopPropagation();this.toggleIconSelector()},this));this.selectorPopup.on("change keyup",".icon-category-select",e.proxy(function(t){if(this.isCategorized===false){return false}var n=e(t.currentTarget),r=n.val();if(n.val()==="all"){this.settings.source=this.backupSource;this.searchValues=this.backupSearch}else{var i=parseInt(r,10);if(this.availableCategories[i]){this.settings.source=this.availableCategories[i];this.searchValues=this.availableCategoriesSearch[i]}}this.resetSearch();this.loadIcons()},this));this.selectorPopup.on("click",".selector-arrow-right",e.proxy(function(e){if(this.currentPage<this.totalPage){this.currentPage=this.currentPage+1;this.renderIconContainer()}},this));this.selectorPopup.on("click",".selector-arrow-left",e.proxy(function(e){if(this.currentPage>1){this.currentPage=this.currentPage-1;this.renderIconContainer()}},this));this.selectorPopup.on("keyup",".icons-search-input",e.proxy(function(t){var n=e(t.currentTarget).val();if(n===""){this.resetSearch();return}this.searchIcon.removeClass("fip-icon-search");this.searchIcon.addClass("fip-icon-cancel");this.isSearch=true;this.currentPage=1;this.iconsSearched=[];e.grep(this.searchValues,e.proxy(function(e,t){if(e.toLowerCase().search(n.toLowerCase())>=0){this.iconsSearched[this.iconsSearched.length]=this.settings.source[t];return true}},this));this.renderIconContainer()},this));this.selectorPopup.on("click",".selector-search .fip-icon-cancel",e.proxy(function(){this.selectorPopup.find(".icons-search-input").focus();this.resetSearch()},this));this.selectorPopup.on("click",".fip-box",e.proxy(function(t){this.setSelectedIcon(e(t.currentTarget).find("i").attr("data-fip-value"));this.toggleIconSelector()},this));this.selectorPopup.click(function(e){e.stopPropagation();return false});if(this.settings.autoClose){e("html").click(e.proxy(function(){if(this.open){this.toggleIconSelector()}},this))}},initSourceIndex:function(){if(typeof this.settings.source!=="object"){return}if(e.isArray(this.settings.source)){this.isCategorized=false;this.selectCategory.html("").hide();this.settings.source=e.map(this.settings.source,function(e,t){if(typeof e.toString=="function"){return e.toString()}else{return e}});if(e.isArray(this.settings.searchSource)){this.searchValues=e.map(this.settings.searchSource,function(e,t){if(typeof e.toString=="function"){return e.toString()}else{return e}})}else{this.searchValues=this.settings.source.slice(0)}}else{var t=e.extend(true,{},this.settings.source);this.settings.source=[];this.searchValues=[];this.availableCategoriesSearch=[];this.selectedCategory=false;this.availableCategories=[];this.unCategorizedKey=null;this.isCategorized=true;this.selectCategory.html("");for(var n in t){var r=this.availableCategories.length,i=e("<option />");i.attr("value",r);i.html(n);this.selectCategory.append(i);this.availableCategories[r]=[];this.availableCategoriesSearch[r]=[];for(var s in t[n]){var o=t[n][s];var u=this.settings.searchSource&&this.settings.searchSource[n]&&this.settings.searchSource[n][s]?this.settings.searchSource[n][s]:o;if(typeof o.toString=="function"){o=o.toString()}if(o&&o!==this.settings.emptyIconValue){this.settings.source.push(o);this.availableCategories[r].push(o);this.searchValues.push(u);this.availableCategoriesSearch[r].push(u)}}}}this.backupSource=this.settings.source.slice(0);this.backupSearch=this.searchValues.slice(0);this.loadCategories()},loadCategories:function(){if(this.isCategorized===false){return}e('<option value="all">'+this.settings.allCategoryText+"</option>").prependTo(this.selectCategory);this.selectCategory.show().val("all").trigger("change")},loadIcons:function(){this.iconContainer.html('<i class="fip-icon-spin3 animate-spin loading"></i>');if(this.settings.source instanceof Array){this.renderIconContainer()}},renderIconContainer:function(){var t,n=[],r;if(this.isSearch){n=this.iconsSearched}else{n=this.settings.source}this.iconsCount=n.length;this.totalPage=Math.ceil(this.iconsCount/this.settings.iconsPerPage);if(this.totalPage>1){this.selectorPopup.find(".selector-footer").show();if(this.currentPage<this.totalPage){this.selectorPopup.find(".selector-arrow-right").show()}else{this.selectorPopup.find(".selector-arrow-right").hide()}if(this.currentPage>1){this.selectorPopup.find(".selector-arrow-left").show()}else{this.selectorPopup.find(".selector-arrow-left").hide()}}else{this.selectorPopup.find(".selector-footer").hide()}this.selectorPopup.find(".selector-pages").html(this.currentPage+"/"+this.totalPage+" <em>("+this.iconsCount+")</em>");t=(this.currentPage-1)*this.settings.iconsPerPage;if(this.settings.emptyIcon){this.iconContainer.html('<span class="fip-box"><i class="fip-icon-block" data-fip-value="fip-icon-block"></i></span>')}else if(n.length<1){this.iconContainer.html('<span class="icons-picker-error"><i class="fip-icon-block" data-fip-value="fip-icon-block"></i></span>');return}else{this.iconContainer.html("")}n=n.slice(t,t+this.settings.iconsPerPage);for(var i=0,s;s=n[i++];){var o=s;e.grep(this.settings.source,e.proxy(function(e,t){if(e===s){o=this.searchValues[t];return true}return false},this));e("<span/>",{html:'<i data-fip-value="'+s+'" '+(this.settings.useAttribute?this.settings.attributeName+'="'+(this.settings.convertToHex?"&#x"+parseInt(s,10).toString(16)+";":s)+'"':'class="'+s+'"')+"></i>","class":"fip-box",title:o}).appendTo(this.iconContainer)}if(!this.settings.emptyIcon&&(!this.element.val()||e.inArray(this.element.val(),this.settings.source)===-1)){this.setSelectedIcon(n[0])}else if(e.inArray(this.element.val(),this.settings.source)===-1){this.setSelectedIcon("")}else{var u=this.element.val();if(u===this.settings.emptyIconValue){u="fip-icon-block"}this.setSelectedIcon(u)}},setHighlightedIcon:function(){this.iconContainer.find(".current-icon").removeClass("current-icon");if(this.currentIcon){this.iconContainer.find('[data-fip-value="'+this.currentIcon+'"]').parent("span").addClass("current-icon")}},setSelectedIcon:function(e){if(e==="fip-icon-block"){e=""}if(this.settings.useAttribute){if(e){this.iconPicker.find(".selected-icon").html("<i "+this.settings.attributeName+'="'+(this.settings.convertToHex?"&#x"+parseInt(e,10).toString(16)+";":e)+'"></i>')}else{this.iconPicker.find(".selected-icon").html('<i class="fip-icon-block"></i>')}}else{this.iconPicker.find(".selected-icon").html('<i class="'+(e||"fip-icon-block")+'"></i>')}this.element.val(e===""?this.settings.emptyIconValue:e).trigger("change");if(this.triggerEvent!==null){for(var t in this.triggerEvent){this.element.trigger(this.triggerEvent[t])}}this.currentIcon=e;this.setHighlightedIcon()},repositionIconSelector:function(){var e=this.iconPicker.offset(),t=e.top+this.iconPicker.outerHeight(true),n=e.left;this.selectorPopup.css({left:n,top:t})},toggleIconSelector:function(){this.open=!this.open?1:0;e(window).off("resize.fonticonpicker");this.selectorPopup.find(".selector-popup").off("clickoutside touchendoutside");if(this.open){if(this.settings.appendTo!=="self"){this.selectorPopup.appendTo(this.settings.appendTo).css({zIndex:1e3}).addClass("icons-selector "+this.settings.theme);this.repositionIconSelector();e(window).on("resize.fonticonpicker",e.proxy(function(){this.repositionIconSelector()},this))}this.selectorPopup.find(".selector-popup").show();var t=this.selectorPopup.width(),n=e(window).width(),r=this.selectorPopup.offset().left,i=this.settings.appendTo=="self"?this.selectorPopup.parent().offset():e(this.settings.appendTo).offset();this.selectorPopup.find(".selector-popup").hide();if(r+t>n-20){this.selectorPopup.css({left:n-20-t-i.left})}if(this.settings.autoClose){this.selectorPopup.find(".selector-popup").on("clickoutside touchendoutside",e.proxy(function(){if(this.open){this.toggleIconSelector()}},this))}}this.selectorPopup.find(".selector-popup").slideToggle(300,e.proxy(function(){this.iconPicker.find(".selector-button i").toggleClass("fip-icon-down-dir");this.iconPicker.find(".selector-button i").toggleClass("fip-icon-up-dir");if(this.open){this.selectorPopup.find(".icons-search-input").focus().select()}else{this.selectorPopup.appendTo(this.iconPicker).css({left:"",top:"",zIndex:""}).removeClass("icons-selector "+this.settings.theme)}},this))},resetSearch:function(){this.selectorPopup.find(".icons-search-input").val("");this.searchIcon.removeClass("fip-icon-cancel");this.searchIcon.addClass("fip-icon-search");this.currentPage=1;this.isSearch=false;this.renderIconContainer()}};e.fn.fontIconPicker=function(t){this.each(function(){if(!e.data(this,"fontIconPicker")){e.data(this,"fontIconPicker",new n(this,t))}});this.setIcons=e.proxy(function(t,n){if(undefined===t){t=false}if(undefined===n){n=false}this.each(function(){e.data(this,"fontIconPicker").settings.source=t;e.data(this,"fontIconPicker").settings.searchSource=n;e.data(this,"fontIconPicker").initSourceIndex();e.data(this,"fontIconPicker").resetSearch();e.data(this,"fontIconPicker").loadIcons()})},this);this.destroyPicker=e.proxy(function(){this.each(function(){if(!e.data(this,"fontIconPicker")){return}e.data(this,"fontIconPicker").iconPicker.remove();e.data(this,"fontIconPicker").element.css({visibility:"",top:"",position:"",zIndex:"",left:"",display:"",height:"",width:"",padding:"",margin:"",border:"",verticalAlign:"","float":""});e.removeData(this,"fontIconPicker")})},this);this.refreshPicker=e.proxy(function(r){if(!r){r=t}this.destroyPicker();this.each(function(){if(!e.data(this,"fontIconPicker")){e.data(this,"fontIconPicker",new n(this,r))}})},this);return this}})(jQuery)